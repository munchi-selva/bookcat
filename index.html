<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://code.jquery.com/jquery-latest.js"></script>
        <script src="https://unpkg.com/ag-grid-enterprise/dist/ag-grid-enterprise.min.noStyle.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
        <link rel="stylesheet" href="https://unpkg.com/ag-grid-enterprise/dist/styles/ag-grid.css">
        <link rel="stylesheet" href="https://unpkg.com/ag-grid-community/dist/styles/ag-theme-balham.css">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    </head>
    <body>

        <div id="testDiv"></div>

        <div id="catGrid" style="height:600px;width:100%;" class="ag-theme-balham" class=".container">
            <h1>Ex libris ... munchi</h1>
            <div id="divCatSelect" class="panel-group">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a id="divCatInfo" data-toggle="collapse" href="#divCatSelectForm">Select a catalogue</a>
                    </h4>
                </div>
                <div id="divCatSelectForm" class="panel-collapse in">
                    <div class="panel-body">
                        <form id="catDataForm" name="catDataForm" enctype="multipart/form-data" method="post">
                            <input type="file" id="fileinputCat">
                            <input type="button" id="btnLoad" value="Load catalogue">
                            <input type="button" id="btnLoadDefault" value="Load default catalogue">
                            <input type="button" id="btnProcessUpdates" value="Save updated catalogue">
                        </form>
                    </div>
                </div>
            </div>
        </div>


        <script type="text/javascript" charset="utf-8">
            const BCK_FLAG_BIT_OPENLIB_SYNCED   = 0;
            const BCK_FLAG_BIT_IN_OPENLIB       = 1;
            const BCK_FLAG_BIT_INVALID_ISBN13   = 2;
            const BCK_FLAG_BIT_INVALID_ISBN10   = 3;
            const ISBN13_DIGITS = 13;
            const ISBN10_DIGITS = 10;

            const CAT_FLD_AMAZON        = "amazon";
            const CAT_FLD_OPENLIB       = "openlib";
            const CAT_FLD_PURCH_DATE    = "purchase_date";
            const CAT_FLD_ARR_DATE      = "arrival_date";
            const CAT_FLD_SELLER        = "seller";
            const CAT_FLD_SELLER_BRANCH = "seller_branch";
            const CAT_FLD_PURCHASER     = "purchaser";
            const CAT_FLD_PURCH_PRICE   = "purchase_price";
            const CAT_FLD_SHIP_PRICE    = "shipping_price";
            const CAT_FLD_CURRENCY      = "purchase_currency";
            const CAT_FLD_NUM_IN_ORDER  = "number_in_order";
            const CAT_FLD_AUTHORS       = "authors";
            const CAT_FLD_TITLE         = "title";
            const CAT_FLD_SUBTITLE      = "subtitle";
            const CAT_FLD_PUBLISHERS    = "publishers";
            const CAT_FLD_FLAGS         = "flags";
            const CAT_FLD_DIM           = "dimensions";
            const CAT_FLD_DIM_HEIGHT    = "height";
            const CAT_FLD_DIM_WIDTH     = "width";
            const CAT_FLD_DIM_THICKNESS = "thickness";
            const CAT_FLD_DIM_LENGTH    = "length";
            const CAT_FLD_DIM_MASS      = "mass";
            const CAT_FLD_INFO_URL      = "info_url";

            // Mapping between currency codes and symbols
            const CURRENCY_PREFIXES =
            {
                "AUD":  "$",
                "EUR":  "€",
                "GBP":  "£",
                "SGD":  "$SGD",
                "USD":  "$US",
                "VND":  "₫"
            };

            // Faking an enum
            const NameEnum =
            {
                "NAME_SUR":     0,
                "NAME_GIVEN":   1
            };
            Object.freeze(NameEnum);

            const REGEX_EXT = new RegExp(/[.][^.]*$/);  // File extension regular expression
            const UPDATED_CAT_EXT = ".updated";

            // Default column options
            const defaultBookCol =
            {
                sortable:   true,
                filter:     true,
                resizable:  true,
                editable:   true
            };

            // Column definitions
            let bookColumns =
            [
                {
                    headerName:         "Resynch",
                    checkboxSelection:  true,
                    headerTooltip:      "Check for updated openlib details",
                },
                {
                    headerName: "In openlib",
                    valueGetter: function(params)
                    {
                        return inOpenLib(params) ? "✓" : "";
                    },
                    headerTooltip: "Book exists in openlib",
                },
                {
                    headerName: "Purchase Details",
                    children:
                    [
                        {
                            headerName: "Purchase Date",
                            field: CAT_FLD_PURCH_DATE
                        },
                        {
                            headerName: "Arrival Date",
                            valueGetter: function(params)
                            {
                                if (hasKeyChain(params.data, []))
                                {
                                    return params.data[CAT_FLD_ARR_DATE];
                                }
                                return params.data[CAT_FLD_PURCH_DATE];
                            },
                            hide: true
                        },
                        {headerName: "Seller", field: CAT_FLD_SELLER},
                        {headerName: "Seller Branch", field: CAT_FLD_SELLER_BRANCH, hide: true},
                        {headerName: "Purchaser", field: CAT_FLD_PURCHASER, hide: true},
                        {headerName: "#", field: CAT_FLD_NUM_IN_ORDER, hide: true},
                        {
                            headerName: "Price",
                            valueGetter: function(params)
                            {
                                let price_string = "";
                                let price = parseFloat(params.data[CAT_FLD_PURCH_PRICE]);
                                if (hasKeyChain(params.data, CAT_FLD_SHIP_PRICE))
                                {
                                    price += parseFloat(params.data[CAT_FLD_SHIP_PRICE]);
                                }

                                if (price)
                                {
                                    if (params.data[CAT_FLD_CURRENCY] == 'VND')
                                    {
                                        price_string = price + CURRENCY_PREFIXES[params.data[CAT_FLD_CURRENCY]];
                                    }
                                    else
                                    {
                                        price_string = CURRENCY_PREFIXES[params.data[CAT_FLD_CURRENCY]] + formatAsCurrency(price);
                                    }
                                }

                                return price_string;
                            }
                        }
                    ]
                },
                {
                    headerName: "Book Identifiers",
                    children:
                    [
                        {
                            headerName: "ISBN 13",
                            field:      "isbn_13",
                            cellRenderer: function(params)
                            {
                                return(formatISBN(params, ISBN13_DIGITS));
                            }
                        },
                        {
                            headerName: "ISBN 10",
                            field:      "isbn_10",
                            cellRenderer: function(params)
                            {
                                return(formatISBN(params, ISBN10_DIGITS));
                            },
                            hide:       true
                        }
                    ]
                },
                {
                    headerName: "Author/Editor",
                    children:
                    [
                        {
                            headerName: "Surname",
                            valueGetter: function(params)
                            {
                                return getAuthorNames(params, NameEnum.NAME_SUR);
                            }
                        },
                        {
                            headerName: "Given Name(s)",
                            valueGetter: function(params)
                            {
                                return getAuthorNames(params, NameEnum.NAME_GIVEN);
                            }
                        }
                    ]
                },
                {
                    headerName: "Title",
                    valueGetter: function(params)
                    {
                        if (hasOpenlibFld(params, CAT_FLD_TITLE))
                        {
                            title = params.data[CAT_FLD_OPENLIB][CAT_FLD_TITLE];
                            if (hasOpenlibFld(params, CAT_FLD_SUBTITLE))
                            {
                                title += ": " + params.data[CAT_FLD_OPENLIB][CAT_FLD_SUBTITLE];
                            }
                            return title;
                        }
                        return params.data[CAT_FLD_TITLE];
                    },
                    cellRenderer: function(params)
                    {
                        cellString = params.value;
                        if (hasOpenlibFld(params, CAT_FLD_INFO_URL))
                        {
                            cellString = '<a href="' + params.data[CAT_FLD_OPENLIB][CAT_FLD_INFO_URL] + '" target="_blank">' + cellString + '</a>';
                        }
                        return cellString;
                    },
                },
                {
                    headerName: "Publisher",
                    valueGetter: function(params)
                    {
                        pubSource = [];
                        if (hasOpenlibFld(params, CAT_FLD_PUBLISHERS))
                        {
                            pubSource = params.data[CAT_FLD_OPENLIB][CAT_FLD_PUBLISHERS];
                        }
                        else if (CAT_FLD_PUBLISHERS in params.data)
                        {
                            pubSource = params.data[CAT_FLD_PUBLISHERS];
                        }
                        return pubSource.join(";");
                    },
                },
                {
                    headerName: "Dimensions",
                    children:
                    [
                        {
                            headerName: "H x W x T",
                            valueGetter: function(params)
                            {
                                dimString = ''
                                dimSource = null
                                if (hasKeyChain(params.data, [CAT_FLD_DIM, CAT_FLD_DIM_HEIGHT]) &&
                                    hasKeyChain(params.data, [CAT_FLD_DIM, CAT_FLD_DIM_WIDTH]) && 
                                    hasKeyChain(params.data, [CAT_FLD_DIM, CAT_FLD_DIM_THICKNESS]))
                                {
                                    dimSource = params.data[CAT_FLD_DIM];
                                }
                                else if (hasKeyChain(params.data, [CAT_FLD_AMAZON, CAT_FLD_DIM, CAT_FLD_DIM_HEIGHT]) &&
                                    hasKeyChain(params.data, [CAT_FLD_AMAZON, CAT_FLD_DIM, CAT_FLD_DIM_WIDTH]) && 
                                    hasKeyChain(params.data, [CAT_FLD_AMAZON, CAT_FLD_DIM, CAT_FLD_DIM_THICKNESS]))
                                {
                                    dimSource = params.data[CAT_FLD_AMAZON][CAT_FLD_DIM];
                                }
                                else if (hasKeyChain(params.data, [CAT_FLD_OPENLIB, CAT_FLD_DIM, CAT_FLD_DIM_HEIGHT]) &&
                                    hasKeyChain(params.data, [CAT_FLD_OPENLIB, CAT_FLD_DIM, CAT_FLD_DIM_WIDTH]) && 
                                    hasKeyChain(params.data, [CAT_FLD_OPENLIB, CAT_FLD_DIM, CAT_FLD_DIM_THICKNESS]))
                                {
                                    dimSource = params.data[CAT_FLD_OPENLIB][CAT_FLD_DIM];
                                }
                                if (dimSource)
                                {
                                    dimString =  dimSource[CAT_FLD_DIM_HEIGHT] + " x " +
                                        dimSource[CAT_FLD_DIM_WIDTH] + " x " +
                                        dimSource[CAT_FLD_DIM_THICKNESS] + "mm";
                                }
                                return dimString;
                            },
                            hide: true
                        },
                        {
                            headerName: "Length",
                            valueGetter: function(params)
                            {
                                if (hasKeyChain(params.data, [CAT_FLD_DIM, CAT_FLD_DIM_LENGTH]))
                                {
                                    return (params.data[CAT_FLD_DIM][CAT_FLD_DIM_LENGTH]);
                                }
                                else if (hasKeyChain(params.data, [CAT_FLD_AMAZON, CAT_FLD_DIM, CAT_FLD_DIM_LENGTH]))
                                {
                                    return (params.data[CAT_FLD_AMAZON][CAT_FLD_DIM][CAT_FLD_DIM_LENGTH]);
                                }
                                else if (hasKeyChain(params.data, [CAT_FLD_OPENLIB, CAT_FLD_DIM, CAT_FLD_DIM_LENGTH]))
                                {
                                    return (params.data[CAT_FLD_OPENLIB][CAT_FLD_DIM][CAT_FLD_DIM_LENGTH]);
                                }
                            },
                            hide: true
                        },
                        {
                            headerName: "Mass",
                            valueGetter: function(params)
                            {
                                if (hasKeyChain(params.data, [CAT_FLD_DIM, CAT_FLD_DIM_MASS]))
                                {
                                    return (params.data[CAT_FLD_DIM][CAT_FLD_DIM_MASS]);
                                }
                                else if (hasKeyChain(params.data, [CAT_FLD_AMAZON, CAT_FLD_DIM, CAT_FLD_DIM_MASS]))
                                {
                                    return (params.data[CAT_FLD_AMAZON][CAT_FLD_DIM][CAT_FLD_DIM_MASS]);
                                }
                                else if (hasKeyChain(params.data, [CAT_FLD_OPENLIB, CAT_FLD_DIM, CAT_FLD_DIM_LENGTH]))
                                {
                                    return (params.data[CAT_FLD_OPENLIB][CAT_FLD_DIM][CAT_FLD_DIM_MASS]);
                                }
                            },
                            hide: true
                        }
                    ]
                }
            ];

            // Grid configuration (empty data)
            let gridOptions =
            {
                defaultColDef:          defaultBookCol,
                columnDefs:             bookColumns,
                rowSelection:           'multiple',
                enableRangeSelection:   true,           // Allow multiple values in the same column to be selected/copied
                suppressRowTransform:   true,           // Allow row spanning
                rowData:                [],
                onRowSelected: function(params)
                {
                    // Toggle selected item's openlib (re)synch flag
                    params.data.flags ^= (1 << BCK_FLAG_BIT_OPENLIB_SYNCED);
                }
            };

            let catFilename = '';
            let catData     = [];

            $(document).ready(function()
            {
                // Initialise the catalogue grid
                let gridDiv = document.querySelector('#catGrid');
                new agGrid.Grid(gridDiv, gridOptions);
                loadDefaultCat();

                // Load/display selected catalogue data
                $("#btnLoad").click(function()
                {
                    let fileinput, fileReader;

                    // Parse file input element
                    fileinput = document.getElementById("fileinputCat");
                    if (!fileinput)
                    {
                        alert("Couldn't find the catalogue file HTML element.");
                    }
                    else if (!fileinput.files)
                    {
                        alert("This browser doesn't seem to support the `files` property of file inputs.");
                    }
                    else if (!fileinput.files[0])
                    {
                        alert("Please select a catalogue file before clicking 'Load'");
                    }
                    else
                    {
                        catFilename = fileinput.files[0].name;
                        catFile = fileinput.files[0];
                        fileReader = new FileReader();
                        fileReader.onload = receivedText;
                        fileReader.readAsText(catFile);
                    }

                    // Proceess catalogue file contents
                    function receivedText(e)
                    {
                        catData = JSON.parse(e.target.result);
                        populateGrid(catData);
                    }
                });

                $("#btnLoadDefault").click(function()
                {
                    loadDefaultCat();
                });

                // Save a version of the catalogue file with selected items flagged
                // for resynch with openlib
                $("#btnProcessUpdates").click(function()
                {
                    let catDataString = JSON.stringify(catData, null, 4);
                    let updatedCatFile = new Blob([catDataString], {type: "text/plain"});
                    let updatedCatFileElem = document.createElement("a");
                    updatedCatFileElem.href = URL.createObjectURL(updatedCatFile);

                    // Generate updated catalogue filename
                    let catFilenameExt  = REGEX_EXT.exec(catFilename);
                    let updatedCatFilename = catFilename.replace(catFilenameExt, UPDATED_CAT_EXT + catFilenameExt);
                    updatedCatFileElem.download = updatedCatFilename;

                    updatedCatFileElem.click();
                });
            });

            function loadDefaultCat()
            {
                catFilename = "Books.cat";

                let xmlhttp = new XMLHttpRequest();
                xmlhttp.onreadystatechange = function()
                {
                    if (this.readyState == 4 && this.status == 200)
                    {
                        let catData = JSON.parse(this.responseText);
                        populateGrid(catData);
                    }
                };
                xmlhttp.open("GET", catFilename, true);
                xmlhttp.send();
            }

            // Populate the catalogue grid
            function populateGrid(catData)
            {
                gridOptions.api.setRowData(catData);
                gridOptions.columnApi.autoSizeColumns();
                gridOptions.api.sizeColumnsToFit();

                document.getElementById("divCatInfo").innerHTML = "Displaying catalogue: '" + catFilename + "'";
            }

            // Format a numerical input as a currency string
            function formatAsCurrency(price)
            {
                return (Number.parseFloat(price).toFixed(2));
            }

            function inOpenLib(params)
            {
                return (params.data.hasOwnProperty('flags') &&
                        params.data.flags & (1 << BCK_FLAG_BIT_IN_OPENLIB));
            }

            function hasOpenlibFld(params, key)
            {
                return (hasKeyChain(params.data, [CAT_FLD_OPENLIB, key]));
            }

            function hasKeyChain(obj, keys)
            {
                for (objLevel = 0; objLevel < keys.length; objLevel++)
                {
                    key = keys[objLevel]
                    if (!obj || !(key in obj))
                    {
                        return false;
                    }
                    obj = obj[key];
                }
                return true;
            }

            function getAuthorNames(params, nameType)
            {
                authSource = [];
                namesString = "";
                if (hasOpenlibFld(params, CAT_FLD_AUTHORS))
                {
                    authSource = params.data[CAT_FLD_OPENLIB][CAT_FLD_AUTHORS];
                }
                else if (CAT_FLD_AUTHORS in params.data)
                {
                    authSource = params.data[CAT_FLD_AUTHORS];
                }
                for (authIdx = 0; authIdx < authSource.length; authIdx++)
                {
                    if (namesString)
                    {
                        namesString += "; ";
                    }
                    if (nameType == NameEnum.NAME_SUR)
                    {
                        namesString += authSource[authIdx].surname;
                    }
                    else if (nameType == NameEnum.NAME_GIVEN)
                    {
                        namesString += authSource[authIdx].given_names.join(" ");
                    }
                }
                return namesString;
            }

            // Format ISBNs so that invalid ISBNs are highlighted
            function formatISBN(params, digits)
            {
                let isbnError = false;
                let cellString = params.value;
                if (CAT_FLD_FLAGS in params.data)
                {
                    switch(digits)
                    {
                        case ISBN13_DIGITS:
                            isbnError = params.data[CAT_FLD_FLAGS] & (1 << BCK_FLAG_BIT_INVALID_ISBN13);
                            break;

                        case ISBN10_DIGITS:
                            isbnError = params.data[CAT_FLD_FLAGS] & (1 << BCK_FLAG_BIT_INVALID_ISBN10);
                            break;

                        default:
                    }
                }

                if (isbnError)
                {
                    cellString = '<span style="background-color:red;">' + cellString + '</span>';
                }

                return cellString;
            }

            // Test catalogue data
            let testCat =
            [
                {
                    "purchase_date": "2019-09-30",
                    "isbn_13": "9781408886809",
                    "item_within_order": "1",
                    "alt_authors": [
                        {
                            "surname": "Gaiman",
                            "given_names": [
                                "Neil"
                            ]
                        }
                    ],
                    "alt_title": "Norse Mythology",
                    "alt_publishers": [
                        {
                            "name": "Bloomsbury"
                        }
                    ],
                    "seller_id": "LL",
                    "purchase_price": "4.00",
                    "purchase_currency": "AUD"
                },
                {
                    "purchase_date": "2019-09-30",
                    "isbn_13": "9780312427245",
                    "item_within_order": "2",
                    "alt_authors": [
                        {
                            "surname": "Vargos Llosa",
                            "given_names": [
                                "Mario"
                            ]
                        },
                        {
                            "surname": "Lane",
                            "given_names": [
                                "Helen",
                                "R."
                            ]
                        }
                    ],
                    "alt_title": "Aunt Julia and the Scriptwriter",
                    "alt_publishers": [
                        {
                            "name": "Picador"
                        }
                    ],
                    "seller_id": "LL",
                    "purchase_price": "4.00",
                    "purchase_currency": "AUD",
                    "ignored_fields": [
                        "authors"
                    ],
                    "isbn_10": [
                        "0312427247"
                    ],
                    "publishers": [
                        {
                            "name": "Picador"
                        }
                    ],
                    "publish_date": "October 2, 2007",
                    "number_of_pages": 384,
                    "title": "Aunt Julia and the Scriptwriter"
                },
                {
                    "purchase_date": "2019-09-30",
                    "isbn_13": "9781780746357",
                    "item_within_order": "3",
                    "alt_authors": [
                        {
                            "surname": "James",
                            "given_names": [
                                "Marlon"
                            ]
                        }
                    ],
                    "alt_title": "A Brief History of Seven Killings",
                    "alt_publishers": [
                        {
                            "name": "Oneworld"
                        }
                    ],
                    "seller_id": "LL",
                    "purchase_price": "3.00",
                    "purchase_currency": "AUD"
                },
                {
                    "purchase_date": "2019-11-29",
                    "isbn_13": "9788891244390",
                    "alt_authors": [
                        {
                            "surname": "Manara",
                            "given_names": [
                                "Milo"
                            ]
                        }
                    ],
                    "alt_title": "Aunt Julia and the Scriptwriter",
                    "seller_id": "AmazonAU",
                    "purchase_price": "36.15",
                    "shipping_price": "0.00",
                    "purchase_currency": "AUD"
                },
                {
                    "arrival_date": "2019-12-01",
                    "isbn_13": "9783462043235",
                    "item_within_order": "1",
                    "alt_authors": [
                        {
                            "surname": "Kutscher",
                            "given_names": [
                                "Volker"
                            ]
                        }
                    ],
                    "alt_title": "Goldstein",
                    "alt_publishers": [
                        {
                            "name": "Kiepenhauer & Witsch"
                        }
                    ],
                    "notes": "Gift",
                    "authors": [
                        {
                            "given_names": [
                                "Volker"
                            ],
                            "surname": "Kutscher"
                        }
                    ],
                    "isbn_10": [
                        "3462043234"
                    ],
                    "publishers": [
                        {
                            "name": "Kiepenheuer & Witsch GmbH"
                        }
                    ],
                    "publish_date": "1822",
                    "title": "Goldstein"
                },
                {
                    "arrival_date": "2019-12-01",
                    "isbn_13": "9783462046465",
                    "item_within_order": "2",
                    "alt_authors": [
                        {
                            "surname": "Kutscher",
                            "given_names": [
                                "Volker"
                            ]
                        }
                    ],
                    "alt_title": "Die Akte Vaterland",
                    "alt_publishers": [
                        {
                            "name": "Kiepenhauer & Witsch"
                        }
                    ],
                    "notes": "Gift"
                },
                {
                    "purchase_date": "2019-12-06",
                    "isbn_13": "9781786070609",
                    "alt_authors": [
                        {
                            "surname": "Sadawi",
                            "given_names": [
                                "Ahmed"
                            ]
                        }
                    ],
                    "alt_title": "Frankenstein in Baghdad",
                    "alt_publishers": [
                        {
                            "name": "Oneworld"
                        }
                    ],
                    "seller_id": "KinokuniyaSyd",
                    "purchase_price": "9.95",
                    "purchase_currency": "AUD",
                    "publishers": [
                        {
                            "name": "Oneworld Publications"
                        }
                    ],
                    "publish_date": "2018",
                    "title": "Frankenstein in Baghdad"
                },
                {
                    "purchase_date": "2019-12-09",
                    "isbn_13": "9780008132576",
                    "alt_authors": [
                        {
                            "surname": "Stephenson",
                            "given_names": [
                                "Neal"
                            ]
                        },
                        {
                            "surname": "Galland",
                            "given_names": [
                                "Nicole"
                            ]
                        }
                    ],
                    "alt_title": "The Rise and Fall of D.O.D.O",
                    "alt_publishers": [
                        {
                            "name": "Harper Collins"
                        }
                    ],
                    "seller_id": "DymocksGeorgeSt",
                    "purchase_price": "10.00",
                    "purchase_currency": "AUD"
                },
                {
                    "purchase_date": "2019-12-10",
                    "isbn_13": "9780730324218",
                    "alt_authors": [
                        {
                            "surname": "Pape",
                            "given_names": [
                                "Scott"
                            ]
                        }
                    ],
                    "alt_title": "The Barefoot Investor",
                    "alt_publishers": [
                        {
                            "name": "Wiley"
                        }
                    ],
                    "seller_id": "DymocksGeorgeSt",
                    "notes": "Gift",
                    "authors": [
                        {
                            "given_names": [
                                "Scott"
                            ],
                            "surname": "Pape"
                        }
                    ],
                    "isbn_10": [
                        "0730324214"
                    ],
                    "publish_date": "2017",
                    "number_of_pages": 264,
                    "title": "The barefoot investor"
                },
                {
                    "purchase_date": "2019-12-16",
                    "isbn_13": "9780692181065",
                    "alt_authors": [
                        {
                            "surname": "McAuliffe",
                            "given_names": [
                                "Callan"
                            ]
                        }
                    ],
                    "alt_title": "The Hill Ghost",
                    "seller_id": "HH_BJ",
                    "purchase_price": "19.95",
                    "purchase_currency": "AUD"
                }
            ];

            //document.getElementById('testDiv').innerHTML = CURRENCY_PREFIXES['AUD'];
        </script>
    </body>
</html>
